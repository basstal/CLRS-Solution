# 概率分析和随机算法

## 5.1-1

Q：证明：假设在过程HIRE-ASSISTANT的第4行中，我们总能决定哪一个应聘者最佳，则意味着我们知道应聘者排名的全部次序。

A：利用数学归纳法证明：

对于1个人的序列，这1个人就是最佳应聘者，也知道应聘者排名的全部次序。

假设对于n个人的序列，我们总能决定哪一个应聘者最佳，并且知道应聘者排名的全部次序。

对于n+1人的序列，我们知道之前n个人排名的全部次序。设新增的人为D，根据概率分布，可能将D与n个人中任意一个做比较，若比较时，我们总能决定哪一个应聘者最佳，即D与n个人的比较关系是确定的。所以D在n个人排名的序列中有一个确定的位置，这个位置之前的所有人次序$\leq rank(D)$，这个位置之后的所有人次序$\geq rank(D)$，所以我们也知道了n+1人排名的全部次序。

--------------------------------------

## 5.1-2

Q：请描述RANDOM(a, b)过程的一种实现，它只调用RANDOM(0, 1)。作为a和b的函数，你的过程的期望运行时间是多少？

A：

```code
RANDOM(a, b):
    c = b - a
    d = 0
    from 1 to c do
        d = d + RANDOM(0, 1)
    return a + d
```

期望运行时间为$(b-a)$。

--------------------------------------

## 5.1-3

Q：假设你希望以1/2的概率输出0与1。你可以自由使用一个输出0或1的过程BIASED-RANDOM。它以某概率p输出1，概率1-p输出0，其中$0\lt p\lt 1$，但是p的值未知。请给出一个利用BIASED-RANDOM作为子程序的算法，返回一个无偏的结果，能以概率1/2返回0，以概率1/2返回1。作为p的函数，你的算法的期望运行时间是多少？

A：

执行两次BIASED-RANDOM输出有4种可能：00、01、10、11，出现概率为

$Pr\{00|11\}=p^2+(1-p)^2$

$Pr\{01\}=(1-p)p$

$Pr\{10\}=p(1-p)$

$Pr\{01\}$和$Pr\{10\}$是等概率的，排除$Pr\{00|11\}$，伪代码如下：

```code
UNBIASED-RANDOM():
    while true
        x = BIASED-RANDOM()
        y = BIASED-RANDOM()
        if x != y
            return x
```

由于每次递归可看作一次伯努利试验，所以递归成功结束的可能性为

$Pr\{success\}=Pr\{01\}+Pr\{10\}=2p(1-p)$

递归次数的期望为$1/(2p(1-p))$，因此期望运行时间为$\Theta(1/(2p(1-p)))$

--------------------------------------

## 5.2-1

Q：在HIRE-ASSISTANT中，假设应聘者以随机顺序出现，你正好雇用一次的概率是多少？正好雇用$n$次的概率是多少？

A：正好雇用一次的概率为$1/n$。正好雇用$n$次必须满足应聘者是以rank递增的顺序排列，总共有$n!$种排列，因此概率为$1/n!$。

--------------------------------------

## 5.2-2

Q：在HIRE-ASSISTANT中，假设应聘者以随机顺序出现，你正好雇用两次的概率是多少？

A：正好雇用两次的概率为$1/n(n-1)$。

--------------------------------------

## 5.2-3

Q：利用指示器随机变量来计算掷$n$个骰子之和的期望值。

A：掷第i个骰子点数期望$X_i$为

$E[X_i]=\sum_{k=1}^6{k\cdot Pr\{{点数k朝上}}\}$

$=\frac{1+2+3+4+5+6}{6}$

$=\frac{21}{6}$

$=3.5$

因此掷$n$个骰子之和的期望为

$E[X]=E[\sum_{i=1}^{n}{X_i}]$

$=\sum_{i=1}^{n}E[X_i]$

$=3.5\cdot n$

--------------------------------------

## 5.2-4

Q：利用指示器随机变量来解如下的**帽子核对问题**：$n$位顾客，他们每个人给餐厅核对帽子的服务生一顶帽子。服务生以随机顺序将帽子归还给顾客。请问拿到自己帽子的客户的期望数是多少？

A：令$X_i=I\{拿到自己的帽子（看作在第i个位置中填入数i）\}=\begin{cases}
1 & 事件H\{i中填入i\}\\
0 & 事件T\{i中填入的不是i\}
\end{cases}$

$Pr\{H\}=1/n$

$E[X]=E[\sum_{i=1}^{n}{X_i}]$

$=\sum_{i=1}^{n}E[X_i]$

$=1$

--------------------------------------

## 5.2-5

Q：设$A[1..n]$是由$n$个不同数构成的数列。如果$i<j$且$A[i]>A[j]$，则称$(i,j)$对为A的一个**逆序对**。假设A的元素构成<1, 2, ..., n>上的一个均匀随机排列。请用指示器随机变量来计算其中逆序对的数目期望。

A：令$X_{ij}=I\{数对ij(i<j)为逆序对\}=\begin{cases}
1 & 事件H\{A[i]>A[j]\} \\
0 & 事件T\{A[i] < A[j] \}
\end{cases}$

$Pr\{H\}=1/2$

$E[X]=E[\sum_{i=1}^{n-1}{\sum_{j=i+1}^{n}{X_{ij}}}]$

$=\sum_{i=1}^{n-1}{\sum_{j=i+1}^{n}{1/2}}$

$=1/2 \sum_{i=1}^{n-1}{n-i}$

$=1/2\cdot \frac{n(n-1)}{2}$

$=\frac{n(n-1)}{4}$

--------------------------------------

## 5.3-1

Q：Marceau教授不同意引理5.5证明中使用的循环不变式。他对第1次迭代之前循环不变式是否为真提出质疑。他的理由是，我们可以很容易宣称一个空数组不包含0排列。因此，一个空的子数组包含一个0排列的概率应是0，从而第1次迭代之前循环不变式无效。请重写过程RANDOMIZE-IN-PLACE，使得相关循环不变式适用于第1次迭代之前的非空子数组，并为你的过程修改引理5.5的证明。

A：
```code
RANDOMIZE-IN-PLACE(A)
    n = A.length
    swap A[1] with A[RANDOM(1, n)]
    for i = 2 to n
        swap A[i] with A[RANDOM(i, n)]
```

循环不变式：第$i-1$次迭代以前，对每个可能的$i-1$排列，子数组$A[1..i-1]$包含这个$i-1$排列的概率是$(n-i+1)!/n!$。

初始化：第1次循环迭代以前，$i=2$由循环不变式可知，对每个可能的1排列，子数组$A[1]$包含这个1排列的概率是$1/n$。因此在第1次循环迭代以前循环不变式成立。

保持：看第$i-1$次迭代，考虑一个特殊的$i$排列，在这个排列中包含一个$i-1$排列，后面接着算法在$A[i]$里放置值$x_i$。设$E_1$表示前$i-2$次迭代已经在$A[1..i-1]$中构造了特殊的$(i-1)$排列的事件。$Pr\{E_1\}=(n-i+1)!/n!$。设$E_2$表示第$i-1$次迭代在位置$A[i]$放置$x_i$的事件。当$E_1$和$E_2$恰好都发生时，$i$排列$<x_1, ..., x_i>$出现在$A[1..i]$中。

$$Pr\{E_2\cap E_1\}=Pr\{E_2|E_1\}Pr\{E_1\}=\frac{1}{n-i+1}\cdot \frac{(n-i+1)!}{n!}=(n-i)!/n!$$

终止：$i=n+1$，子数组$A[1..n]$是一个给定$n$排列的概率为$(n-(n+1)+1)!/n!=1/n!$。

--------------------------------------
